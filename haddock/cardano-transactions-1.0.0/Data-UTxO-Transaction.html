<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Data.UTxO.Transaction</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Data.UTxO.Transaction.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">cardano-transactions-1.0.0: Library utilities for constructing and signing Cardano transactions.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Data.UTxO.Transaction</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Overview</a></li><li><a href="#g:2">Abstraction</a></li><li><a href="#g:3">Note about type-level constraints</a></li></ul></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">class</span> <a href="#t:MkPayment">MkPayment</a> dom <span class="keyword">where</span><ul class="subs"><li><span class="keyword">type</span> <a href="#t:Init">Init</a> dom :: *</li><li><span class="keyword">type</span> <a href="#t:Input">Input</a> dom = inp <span class="keyword">|</span> inp -&gt; dom</li><li><span class="keyword">type</span> <a href="#t:Output">Output</a> dom = out <span class="keyword">|</span> out -&gt; dom</li><li><span class="keyword">type</span> <a href="#t:SignKey">SignKey</a> dom = key <span class="keyword">|</span> key -&gt; dom</li><li><span class="keyword">type</span> <a href="#t:CoinSel">CoinSel</a> dom = sel <span class="keyword">|</span> sel -&gt; dom</li><li><span class="keyword">type</span> <a href="#t:Tx">Tx</a> dom = tx <span class="keyword">|</span> tx -&gt; dom</li><li><a href="#v:empty">empty</a> :: <a href="Data-UTxO-Transaction.html#t:Init" title="Data.UTxO.Transaction">Init</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom</li><li><a href="#v:addInput">addInput</a> :: <a href="Data-UTxO-Transaction.html#t:Input" title="Data.UTxO.Transaction">Input</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom</li><li><a href="#v:addOutput">addOutput</a> :: <a href="Data-UTxO-Transaction.html#t:Output" title="Data.UTxO.Transaction">Output</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom</li><li><a href="#v:lock">lock</a> :: <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> dom</li><li><a href="#v:signWith">signWith</a> :: <a href="Data-UTxO-Transaction.html#t:SignKey" title="Data.UTxO.Transaction">SignKey</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> dom</li><li><a href="#v:serialize">serialize</a> :: <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> dom -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:ErrMkPayment">ErrMkPayment</a><ul class="subs"><li>= <a href="#v:MissingInput">MissingInput</a></li><li>| <a href="#v:MissingOutput">MissingOutput</a></li><li>| <a href="#v:MissingSignature">MissingSignature</a></li></ul></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Overview</h1></a><div class="doc"><p>This module offers an abstraction over the construction of simple UTxO
 transactions. Such a transaction is called a <em>Payment</em>. Payments are
 constructed by selecting inputs and outputs, and signing each input
 independently.</p><p>This can be represented as a state machine, such as:</p><pre>                         empty
                           |
     *-----------------*   |   *----------------*
     |                 |   |   |                |
     |                 v   v   v                |
     *--- addOutput ---=========--- addInput ---*
                           |
                           |
                         lock  *----------------*
                           |   |                |
                           |   v                |
                       =========--- signWith ---*
                           |
                           |
                       serialize
                           |
                           |
                           v
                          ...
</pre><p>Functions from the <code><a href="Data-UTxO-Transaction.html#t:MkPayment" title="Data.UTxO.Transaction">MkPayment</a></code> interfaces are designed to be easy to chain
 like pipes. To give a concrete example, let's see how to construct a
 transaction with <em>one input</em> and <em>two outputs</em>:</p><pre>import Data.Function
    ( (&amp;) )
import qualified Data.UTxO.Transaction as Tx

bytes = Tx.empty
      &amp; Tx.addInput  input0
      &amp; Tx.addOutput output0
      &amp; Tx.addOutput output1
      &amp; Tx.lock
      &amp; Tx.signWith  key0
      &amp; Tx.serialize
</pre><p>The reason why the <code><a href="Data-UTxO-Transaction.html#v:lock" title="Data.UTxO.Transaction">lock</a></code> step is required is because, in order to create
 witnesses, one must produce signatures of the whole transaction body (inputs
 + outputs). Hence, signatures can only be added once all inputs and all
 outputs have already been addded.</p><p>This is correct-by-construction thanks to the <code><a href="Data-UTxO-Transaction.html#v:lock" title="Data.UTxO.Transaction">lock</a></code> step and the distinction
 between <code><a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a></code> and <code><a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a></code>.</p></div><a href="#g:2" id="g:2"><h1>Abstraction</h1></a><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:MkPayment" class="def">MkPayment</a> dom <span class="keyword">where</span> <a href="src/Data.UTxO.Transaction.html#MkPayment" class="link">Source</a> <a href="#t:MkPayment" class="selflink">#</a></p><div class="doc"><p>Abstract interface for constructing a <em>Payment</em>.</p></div><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a id="t:Init" class="def">Init</a> dom :: * <a href="src/Data.UTxO.Transaction.html#Init" class="link">Source</a> <a href="#t:Init" class="selflink">#</a></p><div class="doc"><p>Some initial extra data needed to construct and or serialize the
 transaction. This is a free-type which is implementation-specific.</p><p>For example, Byron transactions requires the underlying protocol magic in
 order to produce witnesses. This is an appropriate place for.</p></div><p class="src"><span class="keyword">type</span> <a id="t:Input" class="def">Input</a> dom = inp <span class="keyword">|</span> inp -&gt; dom <a href="src/Data.UTxO.Transaction.html#Input" class="link">Source</a> <a href="#t:Input" class="selflink">#</a></p><div class="doc"><p>Type representation of transaction <code><a href="Data-UTxO-Transaction.html#t:Input" title="Data.UTxO.Transaction">Input</a></code></p></div><p class="src"><span class="keyword">type</span> <a id="t:Output" class="def">Output</a> dom = out <span class="keyword">|</span> out -&gt; dom <a href="src/Data.UTxO.Transaction.html#Output" class="link">Source</a> <a href="#t:Output" class="selflink">#</a></p><div class="doc"><p>Type representation of transaction <code><a href="Data-UTxO-Transaction.html#t:Output" title="Data.UTxO.Transaction">Output</a></code></p></div><p class="src"><span class="keyword">type</span> <a id="t:SignKey" class="def">SignKey</a> dom = key <span class="keyword">|</span> key -&gt; dom <a href="src/Data.UTxO.Transaction.html#SignKey" class="link">Source</a> <a href="#t:SignKey" class="selflink">#</a></p><div class="doc"><p>Type representation of transaction <code><a href="Data-UTxO-Transaction.html#t:SignKey" title="Data.UTxO.Transaction">SignKey</a></code></p></div><p class="src"><span class="keyword">type</span> <a id="t:CoinSel" class="def">CoinSel</a> dom = sel <span class="keyword">|</span> sel -&gt; dom <a href="src/Data.UTxO.Transaction.html#CoinSel" class="link">Source</a> <a href="#t:CoinSel" class="selflink">#</a></p><div class="doc"><p>An intermediate type for representing a transaction under construction.
 <code><a href="Data-UTxO-Transaction.html#t:Input" title="Data.UTxO.Transaction">Input</a></code> and <code><a href="Data-UTxO-Transaction.html#t:Output" title="Data.UTxO.Transaction">Output</a></code> can still be added to a <code><a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a></code> and must be added
 before trying to sign any of the inputs.</p></div><p class="src"><span class="keyword">type</span> <a id="t:Tx" class="def">Tx</a> dom = tx <span class="keyword">|</span> tx -&gt; dom <a href="src/Data.UTxO.Transaction.html#Tx" class="link">Source</a> <a href="#t:Tx" class="selflink">#</a></p><div class="doc"><p>A transaction is a locked <code><a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a></code> to which it is no longer possible
 to add new <code><a href="Data-UTxO-Transaction.html#t:Input" title="Data.UTxO.Transaction">Input</a></code> and or <code><a href="Data-UTxO-Transaction.html#t:Output" title="Data.UTxO.Transaction">Output</a></code>. Only <code><a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a></code> can be serialized.</p></div></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:empty" class="def">empty</a> :: <a href="Data-UTxO-Transaction.html#t:Init" title="Data.UTxO.Transaction">Init</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom <a href="src/Data.UTxO.Transaction.html#empty" class="link">Source</a> <a href="#v:empty" class="selflink">#</a></p><p class="src"><a id="v:addInput" class="def">addInput</a> :: <a href="Data-UTxO-Transaction.html#t:Input" title="Data.UTxO.Transaction">Input</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom <a href="src/Data.UTxO.Transaction.html#addInput" class="link">Source</a> <a href="#v:addInput" class="selflink">#</a></p><p class="src"><a id="v:addOutput" class="def">addOutput</a> :: <a href="Data-UTxO-Transaction.html#t:Output" title="Data.UTxO.Transaction">Output</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom <a href="src/Data.UTxO.Transaction.html#addOutput" class="link">Source</a> <a href="#v:addOutput" class="selflink">#</a></p><p class="src"><a id="v:lock" class="def">lock</a> :: <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> dom <a href="src/Data.UTxO.Transaction.html#lock" class="link">Source</a> <a href="#v:lock" class="selflink">#</a></p><p class="src"><a id="v:signWith" class="def">signWith</a> :: <a href="Data-UTxO-Transaction.html#t:SignKey" title="Data.UTxO.Transaction">SignKey</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> dom -&gt; <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> dom <a href="src/Data.UTxO.Transaction.html#signWith" class="link">Source</a> <a href="#v:signWith" class="selflink">#</a></p><p class="src"><a id="v:serialize" class="def">serialize</a> :: <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> dom -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Data.UTxO.Transaction.html#serialize" class="link">Source</a> <a href="#v:serialize" class="selflink">#</a></p></div><div class="subs instances"><details id="i:MkPayment" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:MkPayment:MkPayment:1"></span> <a href="Data-UTxO-Transaction.html#t:MkPayment" title="Data.UTxO.Transaction">MkPayment</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a></span> <a href="src/Data.UTxO.Transaction.Cardano.Byron.html#line-222" class="link">Source</a> <a href="#t:MkPayment" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:ic:MkPayment:MkPayment:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-UTxO-Transaction-Cardano-Byron.html">Data.UTxO.Transaction.Cardano.Byron</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="Data-UTxO-Transaction.html#t:Init" title="Data.UTxO.Transaction">Init</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="src/Data.UTxO.Transaction.html#Init" class="link">Source</a> <a href="#t:Init" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Data-UTxO-Transaction.html#t:Input" title="Data.UTxO.Transaction">Input</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> = (inp :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <a href="src/Data.UTxO.Transaction.html#Input" class="link">Source</a> <a href="#t:Input" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Data-UTxO-Transaction.html#t:Output" title="Data.UTxO.Transaction">Output</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> = (out :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <a href="src/Data.UTxO.Transaction.html#Output" class="link">Source</a> <a href="#t:Output" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Data-UTxO-Transaction.html#t:SignKey" title="Data.UTxO.Transaction">SignKey</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> = (key :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <a href="src/Data.UTxO.Transaction.html#SignKey" class="link">Source</a> <a href="#t:SignKey" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> = (sel :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <a href="src/Data.UTxO.Transaction.html#CoinSel" class="link">Source</a> <a href="#t:CoinSel" class="selflink">#</a></p><p class="src"><span class="keyword">type</span> <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> = (tx :: <a href="../base-4.12.0.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a>) <a href="src/Data.UTxO.Transaction.html#Tx" class="link">Source</a> <a href="#t:Tx" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:empty">empty</a> :: <a href="Data-UTxO-Transaction.html#t:Init" title="Data.UTxO.Transaction">Init</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> <a href="src/Data.UTxO.Transaction.html#empty" class="link">Source</a> <a href="#v:empty" class="selflink">#</a></p><p class="src"><a href="#v:addInput">addInput</a> :: <a href="Data-UTxO-Transaction.html#t:Input" title="Data.UTxO.Transaction">Input</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> <a href="src/Data.UTxO.Transaction.html#addInput" class="link">Source</a> <a href="#v:addInput" class="selflink">#</a></p><p class="src"><a href="#v:addOutput">addOutput</a> :: <a href="Data-UTxO-Transaction.html#t:Output" title="Data.UTxO.Transaction">Output</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> -&gt; <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> <a href="src/Data.UTxO.Transaction.html#addOutput" class="link">Source</a> <a href="#v:addOutput" class="selflink">#</a></p><p class="src"><a href="#v:lock">lock</a> :: <a href="Data-UTxO-Transaction.html#t:CoinSel" title="Data.UTxO.Transaction">CoinSel</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> -&gt; <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> <a href="src/Data.UTxO.Transaction.html#lock" class="link">Source</a> <a href="#v:lock" class="selflink">#</a></p><p class="src"><a href="#v:signWith">signWith</a> :: <a href="Data-UTxO-Transaction.html#t:SignKey" title="Data.UTxO.Transaction">SignKey</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> -&gt; <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> -&gt; <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> <a href="src/Data.UTxO.Transaction.html#signWith" class="link">Source</a> <a href="#v:signWith" class="selflink">#</a></p><p class="src"><a href="#v:serialize">serialize</a> :: <a href="Data-UTxO-Transaction.html#t:Tx" title="Data.UTxO.Transaction">Tx</a> <a href="Data-UTxO-Transaction-Cardano-Byron.html#t:Byron" title="Data.UTxO.Transaction.Cardano.Byron">Byron</a> -&gt; <a href="../base-4.12.0.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> <a href="../bytestring-0.10.8.2/Data-ByteString.html#t:ByteString" title="Data.ByteString">ByteString</a> <a href="src/Data.UTxO.Transaction.html#serialize" class="link">Source</a> <a href="#v:serialize" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ErrMkPayment" class="def">ErrMkPayment</a> <a href="src/Data.UTxO.Transaction.html#ErrMkPayment" class="link">Source</a> <a href="#t:ErrMkPayment" class="selflink">#</a></p><div class="doc"><p>Possible errors occuring when constructing a <em>Payment</em>. This can in
 practice be safely ignored if the transaction is known to be well-formed.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:MissingInput" class="def">MissingInput</a></td><td class="doc"><p>Payments must have at least one input.</p></td></tr><tr><td class="src"><a id="v:MissingOutput" class="def">MissingOutput</a></td><td class="doc"><p>Payments must have at least one output</p></td></tr><tr><td class="src"><a id="v:MissingSignature" class="def">MissingSignature</a></td><td class="doc"><p>Payments must have a signature for each input.</p></td></tr></table></div><div class="subs instances"><details id="i:ErrMkPayment" open="open"><summary>Instances</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ErrMkPayment:Eq:1"></span> <a href="../base-4.12.0.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a></span> <a href="src/Data.UTxO.Transaction.html#line-128" class="link">Source</a> <a href="#t:ErrMkPayment" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ErrMkPayment:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-UTxO-Transaction.html">Data.UTxO.Transaction</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> -&gt; <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> -&gt; <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> -&gt; <a href="../base-4.12.0.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ErrMkPayment:Read:2"></span> <a href="../base-4.12.0.0/Text-Read.html#t:Read" title="Text.Read">Read</a> <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a></span> <a href="src/Data.UTxO.Transaction.html#line-128" class="link">Source</a> <a href="#t:ErrMkPayment" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ErrMkPayment:Read:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-UTxO-Transaction.html">Data.UTxO.Transaction</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:readsPrec">readsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.12.0.0/Text-ParserCombinators-ReadP.html#t:ReadS" title="Text.ParserCombinators.ReadP">ReadS</a> <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> <a href="#v:readsPrec" class="selflink">#</a></p><p class="src"><a href="#v:readList">readList</a> :: <a href="../base-4.12.0.0/Text-ParserCombinators-ReadP.html#t:ReadS" title="Text.ParserCombinators.ReadP">ReadS</a> [<a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a>] <a href="#v:readList" class="selflink">#</a></p><p class="src"><a href="#v:readPrec">readPrec</a> :: <a href="../base-4.12.0.0/Text-ParserCombinators-ReadPrec.html#t:ReadPrec" title="Text.ParserCombinators.ReadPrec">ReadPrec</a> <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> <a href="#v:readPrec" class="selflink">#</a></p><p class="src"><a href="#v:readListPrec">readListPrec</a> :: <a href="../base-4.12.0.0/Text-ParserCombinators-ReadPrec.html#t:ReadPrec" title="Text.ParserCombinators.ReadPrec">ReadPrec</a> [<a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a>] <a href="#v:readListPrec" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ErrMkPayment:Show:3"></span> <a href="../base-4.12.0.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a></span> <a href="src/Data.UTxO.Transaction.html#line-128" class="link">Source</a> <a href="#t:ErrMkPayment" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ErrMkPayment:Show:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Data-UTxO-Transaction.html">Data.UTxO.Transaction</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.12.0.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a> -&gt; <a href="../base-4.12.0.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Data-UTxO-Transaction.html#t:ErrMkPayment" title="Data.UTxO.Transaction">ErrMkPayment</a>] -&gt; <a href="../base-4.12.0.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:3" id="g:3"><h1>Note about type-level constraints</h1></a><div class="doc"><p>It is relatively easy to tweak the interface below to get it fully type-safe
 by using an inductive type, such as:</p><pre>data N = Zero | Some N

class MkPayment dom where
    type Init    dom :: *

    type Input   dom = inp | inp -&gt; dom
    type Output  dom = out | out -&gt; dom
    type SignKey dom = key | key -&gt; dom

    type CoinSel dom = (sel :: N -&gt; N -&gt; *) | sel -&gt; dom
    type Tx      dom = (tx  :: N -&gt; *)      | tx  -&gt; dom

    empty     :: Init dom -&gt; CoinSel dom Zero Zero

    addInput  :: Input  dom -&gt; CoinSel dom n m -&gt; CoinSel dom (Some n) m
    addOutput :: Output dom -&gt; CoinSel dom n m -&gt; CoinSel dom n (Some m)

    lock      :: CoinSel dom (Some n) (Some m) -&gt; Tx dom (Some n)

    signWith :: SignKey dom -&gt; Tx dom (Some n) -&gt; Tx dom n

    serialize :: Tx dom Zero -&gt; ByteString
</pre><p>Such approach is great for ensuring that the transaction can't be ill-formed
 and works well when manually constructing the transaction as shown above.</p><p>It gets however quite complex when one wants to start folding or mapping on a
 list of inputs or outputs where their numbers isn't known at compile-time!
 Indeed, each call to <code><a href="Data-UTxO-Transaction.html#v:addInput" title="Data.UTxO.Transaction">addInput</a></code> does actually return a new type!</p><p>Let's say we want to write the following function:</p><pre>addMany :: [Input dom] -&gt; CoinSel dom n m -&gt; CoinSel dom ? m
</pre><p>What should be the type of <code>?</code>. This can't possibly known at compile-time.</p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>